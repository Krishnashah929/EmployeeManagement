@model EM.Entity.User

@{
    Layout = "_LayoutUsers";
}
@{

    ViewData["Title"] = "Index";
    //var returnurl = ViewData["ReturnUrl"] as string;
}

<link href="//cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" rel="stylesheet" />

@{ if (!User.Identity.IsAuthenticated)
    {
        Context.Response.Redirect(Url.Action("Login", "Auth"));
    } }
@if (User.Identity.IsAuthenticated)
{
    <div class="text-center pt-5 mb-5">
        <h1> Index Page </h1>
    </div>
    <!-- Main content -->
    <section class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">  Welcome, List of users</h3>
                        </div>
                        <!-- /.card-header -->
                        <div class="card-body">
                            <div class="table-responsive">
                                <table id="idUserTable" class="table table-bordered">
                                    <thead>
                                        <tr>
                                            <th>UserId</th>
                                            <th>First Name</th>
                                            <th>Last Name</th>
                                            <th>Email</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
}

<!--Edit Model-->
<!--<div class="modal" id="idEditDetails">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content reschedule-model">-->
            <!-- Modal Header -->
            <!--<div class="modal-header">
                <p class="modal-title change-booking-title"
                   id="popup-loginLabel">
                    <b> Edit Your Details </b>
                </p>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>-->
            <!-- Modal body -->
            <!--<div class="modal-body  ">
                <form class="row" method="post">
                    <input type="hidden" class="form-control" id="id" value="" />
                    <div class="col">
                        <label for="idFirstName" class="form-label">
                            First Name
                        </label>
                        <input type="text" class="form-control" id="idFirstName" value="">
                    </div>
                    <div class="col">
                        <label for="idLastName" class="form-label">
                            Last Name
                        </label>
                        <input type="text" class="form-control" id="idLastName" value="">
                    </div>
                    <div class="col">
                        <label for="idEmail" class="form-label">
                            Email Id
                        </label>
                        <input type="text" class="form-control" id="idEmail" value="">
                    </div>
                </form>
                <br>
                <button type="button" class="btn" data-bs-dismiss="modal" onclick="editDetails()" >
                   Update
                </button>
            </div>
        </div>
    </div>
</div>-->

<!--Delete Model-->
<!--<div class="modal" id="idDeleteDetails">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content cancle-model">-->
            <!-- Modal Header -->
            <!--<div class="modal-header">
                <p class="modal-title">
                    <b>
                        Delete User
                    </b>
                </p>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>-->
            <!-- Modal body -->
            <!--<div class="modal-body">
                <div class="row">
                    <div class="col-auto">
                        <p class="text-center">
                            Are you sure you want to delete this user?
                        </p>
                    </div>
                </div>
                <br>
                <button type="button" class="btn" onclick="deleteDetails()" data-bs-dismiss="modal">
                    Delete
                </button>
            </div>
        </div>
    </div>
</div>-->

<script src="//cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
<script>
    $(document).ready(function () {
        $('#idUserTable').DataTable(
            {
                ajax: {
                    url: "GetUserList",
                    type: "POST",
                },
                processing: true,
                serverSide: true,
                filter: true,
                columns: [
                    { data: "userId", name: "UserId" },
                    { data: "firstName", name: "FirstName" },
                    { data: "lastname", name: "Lastname" },
                    { data: "emailAddress", name: "EmailAddress" },
                ],
                "aoColumnDefs": [
                    {
                        "targets": [4],
                        "visible": true,
                        "width": 125,
                        "class": 'text-center',
                        "searchable": false,
                        "render": function (data, type, full, meta) {
                            return '<a style="cursor:pointer;" class="actionIcon icon_history" title="View History" onClick="return Edit(' + full.userId + ')"><i class="fa fa-history"></i></a>'
                                + '<a style="cursor:pointer;" class="actionIcon icon_view" onClick="return Delete(' + full.userId + ')">&nbsp;&nbsp;&nbsp;&nbsp;<i class="fa fa-eye"></i></a>'
                        },
                    }
                ]
            }
        );
    });
    //function idEditDetails(ed) {

    //    var id = ed.getAttribute("data-id");
    //    $.ajax({
    //        url: '/Users/UpdateUserDetailsGet',
    //        type: 'GET',
    //        data: { "id": id },
    //        success: function (response) {
    //            $('#myModalforaddress').modal("show");
    //        }
    //    });
    //}
    //function editDetails() {
    //    var data = {};
    //    data.firstName = document.getElementById("idFirstName").value;
    //    data.lastname = document.getElementById("idLastName").value;
    //    data.emailAddress = document.getElementById("idEmail").value;
    //    $.ajax({
    //        type: 'POST',
    //        url: '/Users/UpdateUserDetailsPost',
    //        contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
    //        data: data,
    //        success: function (result) {
    //            if (result.value == "true") {
    //            }
    //            else {
    //                alert("detailes is invalid");
    //            }
    //        }
    //    })
    //}

    //function idDeleteDetails(da) {
    //    var id = da.getAttribute("data-id");
    //    $.ajax({
    //        url: '/Users/DeleteDetailsModel',
    //        type: 'GET',
    //        data: { "id": id },
    //        success: function (response) {
    //            $('#myModaldeleteaddress').modal("show");
    //        }
    //    });
    //}
    //function deleteDetails() {
    //    var data = {};
    //    data.userId = document.getElementById("id").value;
    //    $.ajax({
    //        url: '/Users/DeleteDetails',
    //        type: 'POST',
    //        data: data,
    //        success: function (result) {
    //            if (result.value == "true") {
    //            }
    //            else {
    //                alert("Invalid");
    //            }
    //        }
    //    });
    //}

</script>
